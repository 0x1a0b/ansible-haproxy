frontend https-in
  bind :443 ssl crt {{ haproxy_ssl_certificate_path }} {% if haproxy_ssl_ciphers %}ciphers {{ haproxy_ssl_ciphers }}{% endif %} {% if haproxy_perfect_forward_secrecy_enabled %}no-tls-tickets{%endif%}

{% if haproxy_restricted_paths is iterable %}
{%   for restricted_path in haproxy_restricted_paths %}
  acl restricted_path path_beg {{ restricted_path }}
{%   endfor %}

{%   for allowed_ip in haproxy_allow_access_to_restricted_paths_from_ips %}
  acl allowed_ip src {{ allowed_ip }}
{%   endfor %}

  http-request deny if restricted_path !allowed_ip
{% endif %}

  default_backend {{ project }}-application
